---
description: 强制同步项目文档规范 - 每次请求必须检查并更新 src/md 目录下的文档
alwaysApply: true
---

# 项目文档同步规范（强制执行）

## 核心规则

**每次收到用户请求时，必须执行以下操作：**

1. **🚨 必读错误日志**：在进行任何代码修改前，**必须先阅读 `src/md/core/13_ERROR_LEARNING_LOG.md`**，避免重复犯错
2. **阅读文档**：阅读 `src/md/` 目录下的相关文档，了解项目当前状态
3. **同步更新**：完成代码修改后，必须更新 `src/md/` 目录下的相关文档，保持文档与代码同步
4. **🚨 记录错误**：如果用户指出错误或 bug，**必须将错误记录到 `src/md/core/13_ERROR_LEARNING_LOG.md`**
5. **🚨 数据库变更**：如涉及数据库修改，**必须遵循 `database-sync` 规则**

## 文档目录结构

```
src/md/
├── README.md                          # 文档索引
├── core/                              # 核心规范与状态
│   ├── 00_AI_DEVELOPER_RULES.md       # AI 开发规范
│   ├── 03_CURRENT_STATUS_LOG.md       # 【重点】项目状态日志
│   ├── 05_AI_HANDOVER_PROTOCOL.md     # AI 交接协议
│   └── 13_ERROR_LEARNING_LOG.md       # 【强制必读】错误学习日志
│
├── design/                            # 设计文档
│   ├── 01_PRODUCT_REQUIREMENTS_DOC.md # 产品需求文档
│   ├── 02_SYSTEM_DESIGN_DOC.md        # 系统设计文档
│   ├── 09_GAMIFICATION_MODULE_DESIGN.md # 游戏化模块设计
│   └── 10_UI_DESIGN_SPECIFICATION.md  # UI 设计规范
│
├── guide/                             # 开发与部署指南
│   ├── 07_FINAL_TASK_BOOK.md          # 最终任务书
│   ├── 08_ULTIMATE_DEV_GUIDE.md       # 终极开发指南
│   ├── 11_QUICK_DEPLOY_GUIDE.md       # 快速部署指南
│   └── 12_AI_SUPER_TEAM_PROMPT_PACK.md # 超级团队 Prompt 包
│
├── deploy/                            # 迁移与部署
│   ├── 14_MIGRATION_DEPLOY_GUIDE.md   # 【重点】一键迁移部署指南
│   └── 15_DATABASE_CHANGELOG.md       # 【强制维护】数据库变更日志
│
└── academic/                          # 学术相关
    └── 04_THESIS_OUTLINE.md           # 论文大纲
```

## 更新优先级

| 优先级 | 文档 | 路径 | 更新时机 |
|-------|------|------|---------|
| **🚨 强制必读** | 错误学习日志 | `core/13_ERROR_LEARNING_LOG.md` | 每次开发前必须阅读 |
| **必须** | 项目状态日志 | `core/03_CURRENT_STATUS_LOG.md` | 每次代码变更后立即更新 |
| **🚨 强制记录** | 错误学习日志 | `core/13_ERROR_LEARNING_LOG.md` | 用户指出错误/bug 时必须记录 |
| **🚨 数据库变更** | 数据库变更日志 | `deploy/15_DATABASE_CHANGELOG.md` | 任何数据库结构变更必须记录 |
| **按需** | 系统设计文档 | `design/02_SYSTEM_DESIGN_DOC.md` | 架构、API 变更时更新 |
| **按需** | 产品需求文档 | `design/01_PRODUCT_REQUIREMENTS_DOC.md` | 功能需求变更时更新 |
| **按需** | 迁移部署指南 | `deploy/14_MIGRATION_DEPLOY_GUIDE.md` | 部署流程变更时更新 |
| **按需** | 其他文档 | - | 涉及相关内容时更新 |

## 错误记录规范

当用户指出错误或 bug 时，必须在 `core/13_ERROR_LEARNING_LOG.md` 中添加记录：

```markdown
### [E编号] 错误简述
- **日期**：YYYY-MM-DD
- **错误类型**：前端/后端/数据库/配置/逻辑/其他
- **错误描述**：详细描述错误内容
- **错误原因**：分析为什么会出错
- **正确做法**：应该怎么做
- **相关文件**：涉及的文件路径
- **教训总结**：一句话总结，便于快速记忆
```

同时更新：
1. 错误分类统计表
2. 如果是高频错误，添加到"高频错误警示"

## 数据库变更规范

**任何数据库相关修改必须同步以下文件：**

1. `src/main/resources/schema.sql` - Spring Boot 自动执行脚本
2. `src/main/resources/sql/study_room_init.sql` - 完整初始化脚本
3. `src/md/deploy/15_DATABASE_CHANGELOG.md` - 变更日志

详细规则参见：`.codebuddy/rules/database-sync/rules/database-sync.mdc`

## 更新格式规范

更新 `core/03_CURRENT_STATUS_LOG.md` 时，在 `**最近更新**:` 下方添加新条目：

```markdown
- **🔧 变更简述**: 详细描述本次修改的内容
```

## 执行检查清单

在每次任务**开始前**，确认：
- [ ] 🚨 **已阅读 `core/13_ERROR_LEARNING_LOG.md`**，了解历史错误
- [ ] 已阅读相关文档

在每次任务**结束前**，确认：
- [ ] 已更新 `core/03_CURRENT_STATUS_LOG.md`
- [ ] 🚨 如用户指出错误，**已记录到 `core/13_ERROR_LEARNING_LOG.md`**
- [ ] 🚨 如涉及数据库变更，**已更新 `deploy/15_DATABASE_CHANGELOG.md`**
- [ ] 如涉及架构/API 变更，已更新 `design/02_SYSTEM_DESIGN_DOC.md`
- [ ] 如涉及部署流程，已更新 `deploy/14_MIGRATION_DEPLOY_GUIDE.md`
